{% macro auth() %}
  <div class="row">
    <span class="label">Your username:</span>
    <input type="text" name="username"/>
  </div>
  
  <div class="row">
    <span class="label">Your password:</span>
    <input type="password" name="passwd"/>
  </div>
{% endmacro %}

{% macro cancel_pending_build(cancel_url, authz, short=False, id='all') %}
  {% if not short or not authz.needAuthForm('cancelPendingBuild') %}
    <form method="post" name="cancel" action="{{ cancel_url }}" class='command cancelbuild'
               {{ 'style="display:inline"' if short else '' }}>
      {% if not short %}
        {% if on_all %}
          <p>To cancel all builds, fill out the following fields and
            push the 'Cancel' button</p>
        {% else %}
          <p>To cancel this build, fill out the following fields and
            push the 'Cancel' button</p>
        {% endif %}
      {% endif %}
      
      {% if authz.needAuthForm('cancelPendingBuild') %}
        {{ auth() }}
      {% elif not short %}
        <p>To cancel individual builds, click the 'Cancel' buttons above.</p>
      {% endif %}
      
      <input type="hidden" name="id" value="{{ id }}" />
      <input type="submit" value="Cancel" />
    </form>
  {% endif %}
{% endmacro %}

{% macro stop_change_builds(stopchange_url, changenum, authz) %}
  {% if not changenum or not authz.needAuthForm('stopChange') %}
    <form method="post" action="{{ stopchange_url }}" class='command stopchange'>
      {% if changenum %}
        <p>To cancel all builds for this change, push the 'Cancel' button</p>
      {% else %}
        <p>To cancel builds for this builder for a given change, fill out all
          fields and push the 'Cancel' button</p>
      {% endif %}

      {% if authz.needAuthForm('cancelPendingBuild') %}
        {{ auth() }}
      {% endif %}

      {% if changenum %}
        <input type="hidden" name="change" value="{{ changenum }}" />
      {% else %}
        <div class="row">
          <span class="label">Change #:</span>
          <input type="text" name="change"/>
        </div>
      {% endif %}
      <input type="submit" value="Cancel" />
    </form>
  {% endif %}
{% endmacro %}

{% macro stop_build(stop_url, authz, on_all=False, on_selected=False, builders=[], short=False, label="Build") %}
  {% if not short or not authz.needAuthForm('stopBuild') %}
    <form method="post" name="stop_build" action="{{ stop_url }}" class='command stopbuild'
               {{ 'style="display:inline"' if short else '' }}>
      {% if not short %}
        {% if on_all %}
          <p>To stop all builds, fill out the following field and
          push the <i>Stop {{ label }}</i> button</p>
        {% elif on_selected %}
          <p>To stop selected builds, select the builders, fill out the
          following field and push the <i>Stop {{ label }}</i> button</p>
          <table>
          {% for b in builders %}
            <tr>
              <td align="center"><input type="checkbox" name="selected" value="{{ b.name }}"></td>
              <td class="box"><a href="{{ b.link }}">{{ b.name|e }}</a></td>
            </tr>
          {% endfor %}
          </table>

        {% else %}
          <p>To stop this build, fill out the following field and
          push the <i>Stop {{ label }}</i> button</p>
        {% endif %}
      {% endif %}
      
      {% if authz.needAuthForm('stopBuild') %}
        {{ auth() }}
      {% endif %}
      
      {% if not short %}
        <div class="row">
          <span class="label">Reason:</span>
          <input type="text" name="comments"/>
        </div>
      {% endif %}
  
      <input type="submit" value="Stop {{ label }}" />
    </form>
  {% endif %}
{% endmacro %}

{% macro force_build(force_url, authz, on_all=False, on_selected=False, builders=[]) %}
 <form method="post" name="force_build" action="{{ force_url }}" class="command forcebuild">

  {% if on_all %}
     <p>To force a build on <strong>all Builders</strong>, fill out the following fields
          and push the 'Force Build' button</p>
  {% elif on_selected %}
     <p>To force a build on <strong>certain Builders</strong>, select the
        builders, fill out the following fields and push the
        'Force Build' button</p>

     <table>
     {% for b in builders %}
       <tr>
         <td align="center"><input type="checkbox" name="selected" value="{{ b.name }}"></td>
         <td class="box"><a href="{{ b.link }}">{{ b.name|e }}</a></td>
       </tr>
     {% endfor %}
     </table>

  {% else %}
     <p>To force a build, fill out the following fields and
        push the 'Force Build' button</p>
  {% endif %}
  
  {% if authz.needAuthForm('forceBuild') %}
    {{ auth() }}
  {% else %}
  <div class="row">
    <span class="label">Your name:</span>
    <input type="text" name="username"/>
  </div>
  {% endif %}
  
  <div class="row">
     <span class="label">Reason for build:</span>
     <input type='text' name='comments' />
  </div>
  <div class="row">
     <span class="label">Project to build:</span>
     <input type='text' name='project' />
  </div>


<!--

Added by elizabeth.flanagan@intel.com
This is specific to yocto-autobuilder

-->

  <div class="row">
     <span class="label">Git Repo:</span>
	 <select name="repository" onChange="setBranch(this.form.repository.options)">
 	 <option value="git://git.yoctoproject.org/poky" >poky:master</option>
	 <option value="git://git.yoctoproject.org/poky-contrib" >poky-contrib:stage/master_under_test</option>
     </select>
  </div>
  <div class="row">
     <span class="label">Git Branch:</span>
     <input type='text' name='branch' value="master"/>
  </div>

  <div class="row">
     <span class="label">Git Revision or Tag:</span>
     <span class="field"><input type="hidden" name="property1name" value="rev" /></span>
     <input type='text' value="HEAD" name="property1value" />
  </div>

  <div class="row">
     <span class="field"><input type="hidden" name="property2name" value="buildbot" /></span>
     <input type='hidden' value="bb0.8.4" name="property2value" />
  </div>

  <p>   <h2>Specific to meta-target buildset ONLY:</h2>
  <hr />
  <div class="row">
     <span class="label">MACHINE:</span>
     <span class="field">
     <span class="field"><input type="hidden" name="property3name" value="machine" /></span>
     <span class="field">
	<select name="property3value">
	<option value="qemux86" SELECTED >qemux86</option>
	<option value="qemux86-64" >qemux86-64</option>
	<option value="qemuarm" >qemuarm</option>
	<option value="qemumips" >qemumips</option>
	<option value="qemuppc" >qemuppc</option>
	<option value="atom-pc" >atom-pc</option>
	<option value="beagleboard" >beagleboard</option>
	<option value="mpc8315e-rdb" >mpc8315e-rdb</option>
	<option value="routerstationpro" >routerstationpro</option>
     </select>
  </div>

  <div class="row">
     <span class="label">SDKMACHINE:</span>
     <span class="field">
     <span class="field"><input type="hidden" name="property4name" value="sdk" /></span>
     <span class="field">
	<select name="property4value">
        <option value="x86" SELECTED >x86</option>
        <option value="x86-64" >x86-64</option>
     </select>
  </div>

  <div class="row">
     <span class="label">Image:</span>
     <span class="field">
     <span class="field"><input type="hidden" name="property5name" value="imagetype"/>
     <input type="hidden" name="property5value" value="blank" />
     <span  class="field">
     <select name="property5value_multi" size=5 multiple onChange="grabImages(this.form.property5value_multi.options)">
        <option value="core-image-sato" SELECTED >core-image-sato</option>
        <option value="core-image-sato-dev" >core-image-sato-dev</option>
        <option value="core-image-sato-sdk" >core-image-sato-sdk</option>
        <option value="core-image-minimal" >core-image-minimal</option>
        <option value="core-image-minimal-dev" >core-image-minimal-dev</option>
     </select>
  </div>


<p>   <h2>Layer Specific Parameters:</h2>
  <hr />
<div id="dynamicLayers">

  <div class="row">
     <span class="label">Layer Git Repo:</span>
     <span class="field">
     <input type="hidden" name="property6name" value="layer0repo" /></span>
     <span class="field">
     <input type='text' name='property6value' value="git://git.yoctoproject.org/meta-intel"/>
     </span>
  </div>
  <div class="row">
     <span class="field">
     <input type="hidden" name="property7name" value="layer0branch" /></span>
     <span class="label">Layer Git Branch:</span>
     <input type='text' name='property7value' value="master"/>
  </div>
  <div class="row">
     <span class="field">
     <input type="hidden" name="property8name" value="layer0revision" /></span>
     <span class="label">Layer Git Revision or Tag:</span>
     <input type='text' name='property8value' value="HEAD"/>
  </div>
  <div class="row">
     <span class="field">
     <input type="hidden" name="property9name" value="layer0workdir" /></span>
     <span class="label">Layer Work Dir from Yocto Root:</span>
     <input type='text' name='property9value' value="yocto/meta-intel"/>
  </div>
  <div class="row">
     <span class="field">
     <input type="hidden" name="property10name" value="layer0priority" /></span>
     <span class="label">Layer Priority:</span>
     <input type='text' name='property10value' value="1"/>
  </div>
    <hr />
</div>  

<input type="button" value="Add another Layer" onClick="addInput('dynamicLayers');">

<!--
  <p>   <h2>Other parameters (not yet implemented):</h2>
  <hr />

  <div class="row">
     <span class="label">Release:</span>
     <span class="field"><input type="hidden" name="property10name" value="release" /></span>
     <span class="field"><input type="radio" name="property10value" /></span>
  </div>

  <div class="row">
     <span class="label">Continuously Build:</span>
     <span class="field"><input type="hidden" name="property11name" value="ci" /></span>
     <span class="field"><input type="radio" name="property11value" /></span>
  </div>

-->


  
  <input type="submit" value="Force Build" /> 
 </form>
{% endmacro %}

{% macro graceful_shutdown(shutdown_url, authz) %}
  <form method="post" action="{{ shutdown_url }}" class='command graceful_shutdown'>
  
  <p>To cause this slave to shut down gracefully when it is idle,
    push the 'Graceful Shutdown' button</p>
    
  {% if authz.needAuthForm('gracefulShutdown') %}
    {{ auth() }}
  {% endif %}
  
  <input type="submit" value="Graceful Shutdown" /> 
 </form>
{% endmacro %}

{% macro clean_shutdown(shutdown_url, authz) %}
  <form method="post" action="{{ shutdown_url }}" class='command clean_shutdown'>
  <p>To cause this master to shut down cleanly, push the 'Clean Shutdown' button.</p>
  <p>No other builds will be started on this master, and the master will
  stop once all current builds are finished.</p>

  {% if authz.needAuthForm('gracefulShutdown') %}
    {{ auth() }}
  {% endif %}

  <input type="submit" value="Clean Shutdown" />
 </form>
{% endmacro %}

{% macro cancel_clean_shutdown(cancel_shutdown_url, authz) %}
  <form method="post" action="{{ cancel_shutdown_url }}" class='command cancel_clean_shutdown'>
  <p>To cancel a previously initiated shutdown, push the 'Cancel Shutdown' button.</p>

  {% if authz.needAuthForm('gracefulShutdown') %}
    {{ auth() }}
  {% endif %}

  <input type="submit" value="Cancel Shutdown" />
 </form>
{% endmacro %}

{% macro ping_builder(ping_url, authz) %}
  <form method="post" action="{{ ping_url }}" class='command ping_builder'>
    <p>To ping the buildslave(s), push the 'Ping' button</p>
  
  {% if authz.needAuthForm('gracefulShutdown') %}
    {{ auth() }}
  {% endif %}
  
    <input type="submit" value="Ping Builder" />
  </form>
{% endmacro %}

{% macro rebuild_build(rebuild_url, authz, exactly, ss) %}
  
   <div class="row">
     <span class="label">The Yocto Autobuilder does not support rebuilds.</span>
   </div>       
 {% endmacro %}

